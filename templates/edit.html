<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î£Ï…Î½Î´ÏÎ¿Î¼Î®Ï‚</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="app-container">
        <nav class="sidebar">
            <div class="sidebar-brand"><i class="fas fa-bolt text-primary me-2"></i> SubsManage</div>
            <div class="sidebar-menu">
                <a href="{{ url_for('home') }}"><i class="fas fa-home me-3"></i> Î‘ÏÏ‡Î¹ÎºÎ®</a>
                <a href="{{ url_for('add_subscription') }}"><i class="fas fa-plus-circle me-3"></i> Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ·</a>
                <a href="{{ url_for('profile') }}"><i class="fas fa-user-cog me-3"></i> Î ÏÎ¿Ï†Î¯Î»</a>
                <a href="{{ url_for('logout') }}" class="mt-5 text-danger"><i class="fas fa-sign-out-alt me-3"></i> Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·</a>
            </div>
        </nav>

        <main class="main-content">
            <a href="{{ url_for('home') }}" class="text-decoration-none text-muted mb-4 d-inline-block">
                <i class="fas fa-arrow-left me-2"></i> Î‘ÎºÏÏÏ‰ÏƒÎ·
            </a>
            
            <div class="row">
                <div class="col-md-8 col-lg-6">
                    <div class="main-card border-warning border-top border-4">
                        <h2 class="mb-4">âœï¸ Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±: {{ sub.name }}</h2>
                        
                        <form method="POST">
                            <div class="mb-4">
                                <label class="form-label">ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</label>
                                <select name="category" class="form-select">
                                    <option value="Entertainment" {% if sub.category == 'Entertainment' %}selected{% endif %}>ğŸ¬ Î”Î¹Î±ÏƒÎºÎ­Î´Î±ÏƒÎ·</option>
                                    <option value="Work" {% if sub.category == 'Work' %}selected{% endif %}>ğŸ’¼ Î•ÏÎ³Î±ÏƒÎ¯Î± & Tools</option>
                                    <option value="Utilities" {% if sub.category == 'Utilities' %}selected{% endif %}>ğŸ  Î£Ï€Î¯Ï„Î¹ & Î›Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Î¯</option>
                                    <option value="Health" {% if sub.category == 'Health' %}selected{% endif %}>ğŸ’ª Î¥Î³ÎµÎ¯Î± & Î“Ï…Î¼Î½Î±ÏƒÏ„Î¹ÎºÎ®</option>
                                    <option value="Education" {% if sub.category == 'Education' %}selected{% endif %}>ğŸ“ Î•ÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ·</option>
                                    <option value="Other" {% if sub.category == 'Other' %}selected{% endif %}>ğŸ“¦ Î†Î»Î»Î¿</option>
                                </select>
                            </div>

                            <div class="mb-4">
                                <label class="form-label">Î¥Ï€Î·ÏÎµÏƒÎ¯Î±</label>
                                <input type="text" name="name" id="serviceInput" class="form-control" value="{{ sub.name }}" required onchange="checkPackages()">
                            </div>

                            <div class="mb-4" id="packageContainer" style="display: none;">
                                <label class="form-label text-warning"><i class="fas fa-tags me-1"></i> Î†Î»Î»Î±Î¾Îµ Î Î±ÎºÎ­Ï„Î¿</label>
                                <select id="packageSelect" class="form-select" onchange="applyPackagePrice()">
                                    <option value="" selected>Î•Ï€Î¯Î»ÎµÎ¾Îµ Ï€Î±ÎºÎ­Ï„Î¿...</option>
                                </select>
                            </div>

                            <div class="mb-4">
                                <label class="form-label">Î¤Î¹Î¼Î® (â‚¬)</label>
                                <input type="number" step="0.01" name="price" id="priceInput" class="form-control" value="{{ sub.price }}" required>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    <label class="form-label">ÎšÏÎºÎ»Î¿Ï‚</label>
                                    <select name="billing_cycle" class="form-select">
                                        <option value="Monthly" {% if sub.billing_cycle == 'Monthly' %}selected{% endif %}>ÎœÎ·Î½Î¹Î±Î¯Î±</option>
                                        <option value="Yearly" {% if sub.billing_cycle == 'Yearly' %}selected{% endif %}>Î•Ï„Î®ÏƒÎ¹Î±</option>
                                        <option value="Weekly" {% if sub.billing_cycle == 'Weekly' %}selected{% endif %}>Î•Î²Î´Î¿Î¼Î±Î´Î¹Î±Î¯Î±</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-4">
                                    <label class="form-label">Î—Î¼. ÎˆÎ½Î±ÏÎ¾Î·Ï‚</label>
                                    <input type="date" name="start_date" class="form-control" value="{{ sub.start_date }}" required>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-warning w-100 fw-bold">ğŸ’¾ Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·</button>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const pricingPackages = {
            'Netflix': [{ name: 'Basic', price: 7.99 }, { name: 'Standard', price: 10.99 }, { name: 'Premium', price: 13.99 }],
            'Spotify': [{ name: 'Individual', price: 7.99 }, { name: 'Duo', price: 10.49 }, { name: 'Family', price: 12.99 }, { name: 'Student', price: 4.49 }],
            'YouTube Premium': [{ name: 'Individual', price: 8.49 }, { name: 'Family', price: 12.99 }],
            'Disney+': [{ name: 'Monthly', price: 10.99 }, { name: 'Yearly', price: 109.90 }],
            'PlayStation Plus': [{ name: 'Essential', price: 8.99 }, { name: 'Extra', price: 13.99 }, { name: 'Premium', price: 16.99 }],
            'ChatGPT Plus': [{ name: 'Plus', price: 22.00 }]
        };

        function checkPackages() {
            const serviceName = document.getElementById('serviceInput').value;
            const packageContainer = document.getElementById('packageContainer');
            const packageSelect = document.getElementById('packageSelect');
            
            packageSelect.innerHTML = '<option value="" selected>Î•Ï€Î¯Î»ÎµÎ¾Îµ Ï€Î±ÎºÎ­Ï„Î¿...</option>';
            const foundKey = Object.keys(pricingPackages).find(key => key.toLowerCase() === serviceName.toLowerCase());

            if (foundKey) {
                packageContainer.style.display = 'block';
                pricingPackages[foundKey].forEach(pkg => {
                    const option = document.createElement('option');
                    option.value = pkg.price;
                    option.text = `${pkg.name} - ${pkg.price}â‚¬`;
                    packageSelect.appendChild(option);
                });
            } else {
                packageContainer.style.display = 'none';
            }
        }

        function applyPackagePrice() {
            const packageSelect = document.getElementById('packageSelect');
            if (packageSelect.value) {
                document.getElementById('priceInput').value = packageSelect.value;
            }
        }

        // Î¤ÏÎ­Î¾Îµ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Î¼ÏŒÎ»Î¹Ï‚ Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹ Î· ÏƒÎµÎ»Î¯Î´Î± (Î³Î¹Î± Ï„Î¿ Edit)
        window.onload = checkPackages;
    </script>
</body>
</html>